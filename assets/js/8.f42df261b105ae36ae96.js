(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{148:function(e,t,n){"use strict";var a=n(17),o=n.n(a),r=n(8),s=function(e){var t=e.getIn;return function(e,n){o()(e,"Form value must be specified");var a=n||function(e){return t(e,"form")};return function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),p=1;p<s;p++)i[p-1]=arguments[p];return o()(i.length,"No fields specified"),1===i.length?t(a(n),e+".values."+i[0]):i.reduce((function(o,s){var i=t(a(n),e+".values."+s);return void 0===i?o:r.a.setIn(o,s,i)}),{})}}};t.a=s(r.a)},331:function(e,t,n){"use strict";var a=n(0),o=n.n(a);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.a=function(e){return o.a.createElement("input",r({type:"hidden",className:"form-control"},e.input))}},334:function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return p})),n.d(t,"a",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(36),o=n.n(a),r=n(14),s=n(1),i=n(5).production.SERVER_URL;function p(e){return function(t){o.a.get("".concat(i,"/trees/single/").concat(e)).then((function(e){var n={};n=e.data?e.data:{category:[],themes:[],images:null},t({type:s.G,payload:n})})).catch((function(e){console.log("error getting tree: ",e)}))}}function c(e){var t={headers:{"content-type":"multipart/form-data"}};return function(n){o.a.post("".concat(i,"/trees/create"),e,t).then((function(e){e.data.error?n(f("There was an error creating the tree: ".concat(e.data.error))):n({type:s.g,payload:e.data})})).catch((function(e){n(f("there was an error creating the tree: ".concat(e)))}))}}function u(e){var t={headers:{"content-type":"multipart/form-data"}};return function(n){o.a.post("".concat(i,"/trees/update"),e,t).then((function(e){var t;e.data.error?n((t="there was an error updating the tree: ".concat(e.data.error),{type:s.gb,payload:t})):n({type:s.fb,payload:e.data})})).catch((function(e){console.log("there was an error updating the tree: ",e)}))}}function l(e,t,n,a){return function(t,n){o.a.post("".concat(i,"/trees/delete"),{tree:e}).then((function(e){e.data.error?console.log("error: ",e.data.error):t(Object(r.e)(n().globalTrees))})).catch((function(e){console.log("error deleting the tree: ",e)}))}}function h(){return{type:s.g,payload:""}}function m(){return{type:s.fb,payload:""}}function f(e){return{type:s.h,payload:e}}}).call(this,n(32))},341:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(100),s=n.n(r),i=n(15);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function u(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(5).production.UPLOADS_PATH;var m=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=u(this,l(t).call(this,e))).state={images:[],deletedImages:[]},n.refType="",n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(a=[{key:"onDeleteClick",value:function(e){this.props.onChange();var t=s()(this.state.images);t.splice(e,1);var n=s()(this.state.deletedImages),a=s()(this.state.images[e]);n.push(a),this.setState({images:t}),this.setState({deletedImages:n}),this.props.updateImages(t,n)}},{key:"onCopyClick",value:function(e){var t='<img alt="'+e.description+'" src="/uploads/'+this.refType+"/"+e.name+'" />';Object(i.a)(t)}},{key:"initImages",value:function(e,t){var n=this;this.refType=t,this.setState({images:e},(function(){n.props.updateImages(e,[])}))}},{key:"renderImages",value:function(){var e=this;return o.a.createElement("div",{className:"drop-preview-wrapper"},this.state.images.map((function(t,n){return o.a.createElement("div",{key:n,className:"drop-preview"},o.a.createElement("a",{href:"#",className:"close-btn",onClick:e.onDeleteClick.bind(e,n)}),o.a.createElement("button",{className:"copy-btn",onClick:e.onCopyClick.bind(e,t)},"copy"),o.a.createElement("img",{className:"drop-img-preview",src:"/uploads/"+e.refType+"/"+Object(i.c)(t.name,"small")}),o.a.createElement("div",{className:"desc"},t.name,o.a.createElement("br",null),t.tag_name&&"tag: "+t.tag_name))})))}},{key:"render",value:function(){return o.a.createElement("div",null,this.renderImages())}}])&&c(n.prototype,a),r&&c(n,r),t}(a.Component);t.a=m},342:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(36),o=n.n(a),r=n(1),s=n(5).production.SERVER_URL;function i(){return function(e){o.a.get("".concat(s,"/tree_tables/all")).then((function(t){e({type:r.z,payload:t.data})})).catch((function(e){console.log("error fetching origins: ",e)}))}}},343:function(e,t,n){"use strict";var a=n(0),o=n.n(a),r=n(92),s=n(329),i=n(335);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){return u(this,t),h(this,m(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(a=[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"renderSelectOptions",value:function(){return this.props.selectItems.map((function(e){return o.a.createElement("option",{key:e.id,value:e.id},e.name)}))}},{key:"render",value:function(){console.log(this.props.customProps);var e=this.props,t=e.meta,n=t.touched,a=t.error,r=e.input,s=e.label;return o.a.createElement("div",{className:"form-group"},o.a.createElement("label",{htmlFor:s},s),o.a.createElement("select",c({className:"dropdown-select",value:r.value,onChange:this.handleChange},r),this.renderSelectOptions()),o.a.createElement("div",{className:"error"},n?a:""))}}])&&l(n.prototype,a),r&&l(n,r),t}(a.Component),b=n(336),d=n(331);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function C(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),C(this,v(t).call(this,e))}var n,a,p;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(r.a,{name:"tree_id",component:d.a,value:this.props.treeId}),o.a.createElement(r.a,{type:"input",label:"common name",name:"common_name",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{type:"input",label:"other common names",name:"other_common_names",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"slug",name:"slug",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"genus_id",label:"genus",component:g,selectItems:this.props.treeTables.genuses,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"specific epithet",name:"specific_epithet",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"other species",name:"other_species",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"subspecies",name:"subspecies",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"variety",name:"variety",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"cultivar",name:"cultivar",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"trees_category_id",label:"category",component:g,selectItems:this.props.treeTables.trees_category,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"zone",name:"zone_id",component:g,selectItems:this.props.treeTables.zones,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"origins",label:"ecoregions",component:b.a,selectItems:this.props.treeTables.origins,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"eco_benefits",label:"eco benefits",component:b.a,selectItems:this.props.treeTables.eco_benefits,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"native_to",label:"native to",component:b.a,selectItems:this.props.treeTables.native_to,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"natural_habitat",label:"natural habitat",component:b.a,selectItems:this.props.treeTables.natural_habitat,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"shapes",label:"shapes",component:b.a,selectItems:this.props.treeTables.shapes,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"light",label:"light",component:b.a,selectItems:this.props.treeTables.light,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"height min",name:"height_min",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"height max",name:"height_max",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"width min",name:"width_min",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"width max",name:"width_max",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"growth rate",name:"growth_rate",component:g,selectItems:[{id:"slow",slug:"slow",name:"slow"},{id:"medium",slug:"medium",name:"medium"},{id:"fast",slug:"fast",name:"fast"}],onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"lifespan min",name:"lifespan_min",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{label:"lifespan max",name:"lifespan_max",component:s.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"soil",label:"soil",component:b.a,selectItems:this.props.treeTables.soil,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"common_uses",label:"common uses",component:b.a,selectItems:this.props.treeTables.common_uses,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"transplanting",label:"transplanting",component:b.a,selectItems:this.props.treeTables.transplanting,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"unique_attractions",label:"unique attractions",component:b.a,selectItems:this.props.treeTables.unique_attractions,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"tolerances",label:"tolerances",component:b.a,selectItems:this.props.treeTables.tolerances,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"reproduction_type_id",label:"reproduction types",component:g,selectItems:this.props.treeTables.reproduction_types,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"insects",label:"insects",component:b.a,selectItems:this.props.treeTables.insects,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{name:"diseases",label:"diseases",component:b.a,selectItems:this.props.treeTables.diseases,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),o.a.createElement(r.a,{type:"textarea",label:"body",name:"body",component:i.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}))}}])&&_(n.prototype,a),p&&_(n,p),t}(a.Component);t.a=E},370:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(92),s=n(148),i=n(93),p=n(334),c=n(342),u=n(326),l=n(6),h=n(331),m=n(341),f=n(338),g=n(337),b=n(328),d=n(100),y=n.n(d),_=n(343);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function I(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=I(this,E(t).call(this,e))).state={images:[],imagesToDelete:[],selectedItem:""},n}var n,a,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,e),n=t,(a=[{key:"componentWillMount",value:function(){this.props.fetchTreeTables(),this.props.getTree(this.props.match.params.treeId)}},{key:"componentDidUpdate",value:function(e){this.props.treeData&&e.treeData!==this.props.treeData&&this.handleInitialize()}},{key:"componentWillUnmount",value:function(){this.clearMessages()}},{key:"clearMessages",value:function(){this.props.clearUpdateTree()}},{key:"handleInitialize",value:function(){var e=y()(this.props.treeData.images);this.setState({images:e}),this.refs.UploadedImages.initImages(e,"trees");var t={tree_id:this.props.treeData.id,common_name:this.props.treeData.common_name,other_common_names:this.props.treeData.other_common_names,slug:this.props.treeData.slug,specific_epithet:this.props.treeData.specific_epithet,other_species:this.props.treeData.other_species,subspecies:this.props.treeData.subspecies,variety:this.props.treeData.variety,cultivar:this.props.treeData.cultivar,body:this.props.treeData.body,genus_id:this.props.treeData.genus_id,trees_category_id:this.props.treeData.trees_category_id,zone_id:this.props.treeData.zone_id,reproduction_type_id:this.props.treeData.reproduction_type_id,height_min:this.props.treeData.height_min,height_max:this.props.treeData.height_max,width_min:this.props.treeData.width_min,width_max:this.props.treeData.width_max,growth_rate:this.props.treeData.growth_rate,lifespan_min:this.props.treeData.lifespan_min,lifespan_max:this.props.treeData.lifespan_max,origins:this.formatToMultiselect(this.props.treeData.origins),eco_benefits:this.formatToMultiselect(this.props.treeData.eco_benefits),native_to:this.formatToMultiselect(this.props.treeData.native_to),shapes:this.formatToMultiselect(this.props.treeData.shapes),light:this.formatToMultiselect(this.props.treeData.light),soil:this.formatToMultiselect(this.props.treeData.soil),natural_habitat:this.formatToMultiselect(this.props.treeData.natural_habitat),common_uses:this.formatToMultiselect(this.props.treeData.common_uses),transplanting:this.formatToMultiselect(this.props.treeData.transplanting),unique_attractions:this.formatToMultiselect(this.props.treeData.unique_attractions),tolerances:this.formatToMultiselect(this.props.treeData.tolerances),insects:this.formatToMultiselect(this.props.treeData.insects),diseases:this.formatToMultiselect(this.props.treeData.diseases)};this.props.initialize(t)}},{key:"handleFormSubmit",value:function(e){var t;t=Object(g.b)(e,["origins","eco_benefits","native_to","shapes","light","soil","natural_habitat","common_uses","transplanting","unique_attractions","tolerances","insects","diseases"]),this.props.updateTree(Object(g.a)("new_images",t)),this.props.change("deleted_images","")}},{key:"formatToMultiselect",value:function(e){return e.map((function(e){return{value:e.id,label:e.name}}))}},{key:"renderUpdated",value:function(){if(this.props.treeUpdated)return o.a.createElement("div",{className:"submission-message"},o.a.createElement("span",null,"Tree: ",this.props.treeUpdated.common_name,o.a.createElement("br",null),"successfully updated."))}},{key:"updatedImages",value:function(e,t){var n=[];Object.keys(t).forEach((function(e){n[e]=t[e].name})),this.props.change("deleted_images",n.toString()),console.log(e),this.props.change("images",JSON.stringify(e))}},{key:"onInputChange",value:function(){this.clearMessages()}},{key:"render",value:function(){var e=this.props.handleSubmit;return o.a.createElement("div",{className:"admin-main"},o.a.createElement("div",{className:"row"},o.a.createElement(u.a,null),o.a.createElement("div",{className:"main-window columns small-12 large-9"},o.a.createElement("h3",null,"Edit Plant"),o.a.createElement("form",{onSubmit:e(this.handleFormSubmit.bind(this))},o.a.createElement(_.a,{treeId:this.props.treeData.id,onInputChange:this.onInputChange.bind(this),treeTables:this.props.treeTables}),o.a.createElement(m.a,{ref:"UploadedImages",updateImages:this.updatedImages.bind(this),onChange:this.onInputChange.bind(this)}),o.a.createElement(r.a,{name:"deleted_images",component:h.a}),o.a.createElement(r.a,{name:"images",component:h.a}),o.a.createElement(f.a,{name:"new_images",label:"New Images",classNameLabel:"file-input-label",onChange:this.onInputChange.bind(this),tags:this.props.treeTables.tags}),o.a.createElement("button",{action:"submit",className:"btn btn-primary"},"Submit")),this.renderUpdated())))}}])&&v(n.prototype,a),s&&v(n,s),t}(a.Component);t.default=Object(b.a)(Object(i.a)({validate:function(e){var t={};return e.common_name||(t.common_name="Please enter a common name"),e.slug||(t.slug="Please enter a slug"),t},form:"tree-add",fields:["common_name","slug","body"]})(Object(l.b)((function(e,t){return Object(s.a)("tree-add"),{treeUpdated:e.tree.treeUpdated,treeData:e.tree.treeSingle,treeTables:e.treeTables.all}}),{getTree:p.f,clearUpdateTree:p.d,updateTree:p.g,fetchTreeTables:c.a})(T)))}}]);