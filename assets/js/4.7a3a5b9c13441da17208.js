(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{330:function(e,t,n){"use strict";n.r(t),n.d(t,"addCategory",(function(){return c})),n.d(t,"fetchCategories",(function(){return s})),n.d(t,"deleteCategory",(function(){return u})),n.d(t,"getCategory",(function(){return l})),n.d(t,"updateCategory",(function(){return p})),n.d(t,"clearUpdateCategory",(function(){return f})),n.d(t,"clearCategory",(function(){return h})),n.d(t,"addCategoryError",(function(){return g}));var a=n(36),r=n.n(a),o=n(1),i=n(5).production.SERVER_URL;function c(e){return function(t){r.a.post("".concat(i,"/categories/create"),e).then((function(e){e.data.error?t(g("there was an error adding the category: ".concat(e.data.error))):t({type:o.c,payload:e.data})})).catch((function(e){t(g("there was an error adding the category: ".concat(e)))}))}}function s(){return function(e){r.a.get("".concat(i,"/categories/all")).then((function(t){e({type:o.v,payload:t.data})})).catch((function(e){console.log("error fetching categories: ",e)}))}}function u(e){var t=e.slug;return function(e){r.a.post("".concat(i,"/categories/delete"),{slug:t}).then((function(t){t.data.error?console.log("error: ",t.data.error):e(s())})).catch((function(e){console.log("error deleting the category: ",e)}))}}function l(e){return function(t){r.a.get("".concat(i,"/categories/single/").concat(e)).then((function(e){t({type:o.D,payload:e.data})})).catch((function(e){console.log("error getting category: ",e)}))}}function p(e){return function(t){r.a.post("".concat(i,"/categories/update"),e).then((function(e){e.data.error?t(updateCategoryError("there was an error updating the category: ".concat(e.data.error))):t({type:o.db,payload:e.data})})).catch((function(e){console.log("error upating category: ",e)}))}}function f(){return{type:o.db,payload:""}}function h(){return{type:o.c,payload:""}}function g(e){return{type:o.d,payload:e}}},331:function(e,t,n){"use strict";var a=n(0),r=n.n(a);function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}t.a=function(e){return r.a.createElement("input",o({type:"hidden",className:"form-control"},e.input))}},333:function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return g}));var a=n(36),r=n.n(a),o=n(25),i=n(1),c=n(5).production.SERVER_URL;function s(e){return function(t){r.a.get("".concat(c,"/articles/single/").concat(e)).then((function(e){var n={};n=e.data?e.data:{category:[],themes:[],images:null},t({type:i.C,payload:n})})).catch((function(e){console.log("error getting article: ",e)}))}}function u(e){var t={headers:{"content-type":"multipart/form-data"}};return function(n){r.a.post("".concat(c,"/articles/create"),e,t).then((function(e){e.data.error?n(g("There was an error creating the article: ".concat(e.data.error))):n({type:i.a,payload:e.data})})).catch((function(e){n(g("there was an error creating the article: ".concat(e)))}))}}function l(e){var t={headers:{"content-type":"multipart/form-data"}};return function(n){r.a.post("".concat(c,"/articles/update"),e,t).then((function(e){var t;e.data.error?n((t="there was an error updating the article: ".concat(e.data.error),{type:i.cb,payload:t})):n({type:i.bb,payload:e.data})})).catch((function(e){console.log("there was an error updating the article: ",e)}))}}function p(e,t,n,a){return function(t,n){r.a.post("".concat(c,"/articles/delete"),{article:e}).then((function(e){e.data.error?console.log("error: ",e.data.error):t(Object(o.searchArticles)(n().global))})).catch((function(e){console.log("error deleting the article: ",e)}))}}function f(){return{type:i.a,payload:""}}function h(){return{type:i.bb,payload:""}}function g(e){return{type:i.b,payload:e}}}).call(this,n(32))},339:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(36),r=n.n(a),o=n(1),i=n(5).production.SERVER_URL;function c(){return function(e){r.a.get("".concat(i,"/tags/all")).then((function(t){e({type:o.x,payload:t.data})})).catch((function(e){console.log("error fetching tags: ",e)}))}}},340:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(92),i=n(329),c=n(335),s=n(336);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function p(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),p(this,f(t).call(this,e))}var n,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(a=[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(o.a,{type:"input",label:"name:",name:"name",component:i.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),r.a.createElement(o.a,{label:"slug:",name:"slug",component:i.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),r.a.createElement(o.a,{name:"categories",label:"categories",component:s.a,selectItems:this.props.categories,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),r.a.createElement(o.a,{name:"tags",label:"tags",component:s.a,selectItems:this.props.tags,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}),r.a.createElement(o.a,{type:"textarea",label:"body",name:"body",component:c.a,onChange:this.props.onInputChange,onFocus:this.props.onInputChange}))}}])&&l(n.prototype,a),u&&l(n,u),t}(a.Component);t.a=g},341:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(100),i=n.n(o),c=n(15);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n(5).production.UPLOADS_PATH;var h=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=l(this,p(t).call(this,e))).state={images:[],deletedImages:[]},n.refType="",n}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),n=t,(a=[{key:"onDeleteClick",value:function(e){this.props.onChange();var t=i()(this.state.images);t.splice(e,1);var n=i()(this.state.deletedImages),a=i()(this.state.images[e]);n.push(a),this.setState({images:t}),this.setState({deletedImages:n}),this.props.updateImages(t,n)}},{key:"onCopyClick",value:function(e){var t='<img alt="'+e.description+'" src="/uploads/'+this.refType+"/"+e.name+'" />';Object(c.a)(t)}},{key:"initImages",value:function(e,t){var n=this;this.refType=t,this.setState({images:e},(function(){n.props.updateImages(e,[])}))}},{key:"renderImages",value:function(){var e=this;return r.a.createElement("div",{className:"drop-preview-wrapper"},this.state.images.map((function(t,n){return r.a.createElement("div",{key:n,className:"drop-preview"},r.a.createElement("a",{href:"#",className:"close-btn",onClick:e.onDeleteClick.bind(e,n)}),r.a.createElement("button",{className:"copy-btn",onClick:e.onCopyClick.bind(e,t)},"copy"),r.a.createElement("img",{className:"drop-img-preview",src:"/uploads/"+e.refType+"/"+Object(c.c)(t.name,"small")}),r.a.createElement("div",{className:"desc"},t.name,r.a.createElement("br",null),t.tag_name&&"tag: "+t.tag_name))})))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderImages())}}])&&u(n.prototype,a),o&&u(n,o),t}(a.Component);t.a=h},376:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(92),i=n(93),c=n(333),s=n(330),u=n(339),l=n(326),p=n(6),f=n(340),h=n(331);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(){return(m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function b(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var O=function(e){function t(){return d(this,t),b(this,v(t).apply(this,arguments))}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,e),n=t,(a=[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"renderSelectOptions",value:function(){return this.props.selectItems.map((function(e){return r.a.createElement("option",{key:e.id,value:e.name},e.name)}))}},{key:"render",value:function(){console.log(this.props.customProps);var e=this.props,t=e.meta,n=t.touched,a=t.error,o=e.input,i=e.label;return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:i},i),r.a.createElement("select",m({className:"dropdown-select",value:o.value,onChange:this.handleChange},o),this.renderSelectOptions()),r.a.createElement("div",{className:"error"},n?a:""))}}])&&y(n.prototype,a),o&&y(n,o),t}(a.Component),C=n(341),E=n(338),_=n(337),I=(n(12),n(328)),S=n(100),j=n.n(S);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var U=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=T(this,D(t).call(this,e))).state={images:[],imagesToDelete:[],selectedItem:""},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),n=t,(a=[{key:"componentWillMount",value:function(){this.props.fetchCategories(),this.props.fetchTags(),this.props.getArticle(this.props.match.params.articleId)}},{key:"componentDidUpdate",value:function(e){this.props.articleData&&e.articleData!==this.props.articleData&&this.handleInitialize()}},{key:"componentWillUnmount",value:function(){this.clearMessages()}},{key:"clearMessages",value:function(){this.props.clearUpdateArticle()}},{key:"handleInitialize",value:function(){var e=j()(this.props.articleData.images);this.setState({images:e}),this.refs.UploadedImages.initImages(e,"articles");var t={name:this.props.articleData.name,slug:this.props.articleData.slug,category:this.props.articleData.category_id,categories:this.formatToMultiselect(this.props.articleData.categories),tags:this.formatToMultiselect(this.props.articleData.tags),body:this.props.articleData.body,featured_image:this.props.articleData.featured_image};this.props.initialize(t)}},{key:"handleFormSubmit",value:function(e){var t;t=Object(_.b)(e,["categories","tags"]),this.props.updateArticle(Object(_.a)("new_images",t)),this.props.change("deleted_images","")}},{key:"formatToMultiselect",value:function(e){return e.map((function(e){return{value:e.id,label:e.name}}))}},{key:"renderUpdated",value:function(){if(this.props.articleUpdated)return r.a.createElement("div",{className:"submission-message"},r.a.createElement("span",null,"Article: ",this.props.articleUpdated.name,r.a.createElement("br",null),"successfully updated."))}},{key:"updatedImages",value:function(e,t){var n=[];Object.keys(t).forEach((function(e){n[e]=t[e].name})),this.props.change("deleted_images",n.toString()),this.props.change("images",JSON.stringify(e))}},{key:"newImages",value:function(e){console.log(e)}},{key:"onInputChange",value:function(){this.clearMessages()}},{key:"render",value:function(){var e=this.props.handleSubmit;return r.a.createElement("div",{className:"admin-main"},r.a.createElement("div",{className:"row"},r.a.createElement(l.a,null),r.a.createElement("div",{className:"main-window columns small-12 large-9"},r.a.createElement("h3",null,"Edit Article"),r.a.createElement("form",{onSubmit:e(this.handleFormSubmit.bind(this))},r.a.createElement(f.a,{onInputChange:this.onInputChange.bind(this),treeTables:this.props.treeTables,categories:this.props.categories,tags:this.props.tags}),r.a.createElement(o.a,{name:"featured_image",label:"featured image",component:O,selectItems:this.state.images,onChange:this.onInputChange.bind(this),onFocus:this.onInputChange.bind(this)}),r.a.createElement(C.a,{ref:"UploadedImages",updateImages:this.updatedImages.bind(this),onChange:this.onInputChange.bind(this)}),r.a.createElement(o.a,{name:"deleted_images",component:h.a}),r.a.createElement(o.a,{name:"images",component:h.a}),r.a.createElement(E.a,{name:"new_images",label:"New Images:",classNameLabel:"file-input-label",onChange:this.onInputChange.bind(this),tags:[{id:"1",name:"test tag"}],newImages:this.newImages.bind(this)}),r.a.createElement("button",{action:"submit",className:"btn btn-primary"},"Submit")),this.renderUpdated())))}}])&&P(n.prototype,a),i&&P(n,i),t}(a.Component);t.default=Object(I.a)(Object(i.a)({validate:function(e){var t={};return e.name||(t.name="Please enter a name"),e.slug||(t.slug="Please enter a slug"),e.category||(t.category="Please enter a type"),e.categories&&0===e.categories.length&&(t.categories="Please enter at least one category"),t},form:"article-add",fields:["name","slug"]})(Object(p.b)((function(e,t){return{articleUpdated:e.article.articleUpdated,articleData:e.article.articleSingle,categories:e.categories.all,tags:e.tags.all}}),{getArticle:c.f,clearUpdateArticle:c.d,updateArticle:c.g,fetchTags:u.a,fetchCategories:s.fetchCategories})(U)))}}]);